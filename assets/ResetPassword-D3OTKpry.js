import{c as D,y as I,u as A,a2 as M,r as t,ao as z,ap as w,aq as R,j as s,F as d,G as i,J as l,H as m,K as x,B as f,a1 as U,ar as q,as as j,at as g,au as N,av as y,I as b,aw as P,ax as B,aH as H}from"./index-DBMRuhZV.js";import{A as G,b as J}from"./alert-CEvXgpj2.js";import{C as K}from"./circle-check-big-VS_F3nKF.js";/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const V=D("TriangleAlert",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);function O(){const{t:e}=I("auth"),{updatePassword:v}=A(),[,o]=M(),[h,c]=t.useState(""),[L,C]=t.useState(!1),[S,k]=t.useState(null),[u,p]=t.useState(!1),E=z({password:w().min(6,e("zod.passwordMin")),confirmPassword:w()}).refine(r=>r.password===r.confirmPassword,{message:e("zod.passwordsDontMatch"),path:["confirmPassword"]}),n=R({resolver:B(E),defaultValues:{password:"",confirmPassword:""}});t.useEffect(()=>{const a=new URLSearchParams(window.location.hash.substring(1)).get("error_description");if(a){const T=decodeURIComponent(a.replace(/\+/g," "));k(T)}},[o]);const F=async r=>{try{c(""),p(!0),await v(r.password),C(!0),setTimeout(()=>{o("~/dashboard")},2e3)}catch(a){a instanceof H&&c(e("zod.passwordsDontMatch")),c(a instanceof Error?a.message:e("updatePasswordFailed"))}finally{p(!1)}};return L?s.jsx("div",{className:"min-h-screen crypto-pattern flex items-center justify-center p-4",children:s.jsxs(d,{className:"w-full max-w-md",children:[s.jsxs(i,{className:"text-center",children:[s.jsx("div",{className:"mx-auto w-12 h-12 bg-green-600 rounded-lg flex items-center justify-center mb-4",children:s.jsx(K,{className:"w-7 h-7 text-white"})}),s.jsx(l,{className:"text-2xl font-bold",children:e("passwordUpdated")}),s.jsx(m,{children:e("passwordUpdateSuccess")})]}),s.jsx(x,{className:"text-center",children:s.jsx("p",{className:"text-sm text-muted-foreground",children:e("redirectingToDashboard")})})]})}):S?s.jsx("div",{className:"min-h-screen crypto-pattern flex items-center justify-center p-4",children:s.jsxs(d,{className:"w-full max-w-md",children:[s.jsxs(i,{className:"text-center",children:[s.jsx("div",{className:"mx-auto w-12 h-12 bg-destructive rounded-lg flex items-center justify-center mb-4",children:s.jsx(V,{className:"w-7 h-7 text-destructive-foreground"})}),s.jsx(l,{className:"text-2xl font-bold",children:e("invalidLinkTitle")}),s.jsx(m,{children:e("invalidLinkError")})]}),s.jsx(x,{className:"text-center",children:s.jsx(f,{onClick:()=>o("/forgot-password"),variant:"default",children:e("requestNewLink")})})]})}):s.jsx("div",{className:"min-h-screen crypto-pattern flex items-center justify-center p-4",children:s.jsxs(d,{className:"w-full max-w-md",children:[s.jsxs(i,{className:"text-center",children:[s.jsx("div",{className:"mx-auto w-12 h-12 gradient-bg rounded-lg flex items-center justify-center mb-4",children:s.jsx(U,{className:"w-9 h-9",forcedTheme:"dark"})}),s.jsx(l,{className:"text-2xl font-bold",children:e("resetPassword")}),s.jsx(m,{children:e("resetPasswordDescription")})]}),s.jsx(x,{children:s.jsx(q,{...n,children:s.jsxs("form",{onSubmit:n.handleSubmit(F),className:"space-y-4",children:[s.jsx(j,{control:n.control,name:"password",render:({field:r})=>s.jsxs(g,{children:[s.jsx(N,{children:e("newPassword")}),s.jsx(y,{children:s.jsx(b,{type:"password",placeholder:e("newPasswordPlaceholder"),"data-testid":"input-password",...r})}),s.jsx(P,{})]})}),s.jsx(j,{control:n.control,name:"confirmPassword",render:({field:r})=>s.jsxs(g,{children:[s.jsx(N,{children:e("confirmPassword")}),s.jsx(y,{children:s.jsx(b,{type:"password",placeholder:e("confirmNewPasswordPlaceholder"),"data-testid":"input-confirm-password",...r})}),s.jsx(P,{})]})}),h&&s.jsx(G,{variant:"destructive",children:s.jsx(J,{"data-testid":"error-reset-password",children:h})}),s.jsx(f,{type:"submit",className:"w-full",disabled:u,"data-testid":"button-update-password",children:e(u?"common:updating":"updatePassword")})]})})})]})})}export{O as default};
